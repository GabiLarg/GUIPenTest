import library


class theHarvester:
    operacional = ''
    hosts = 0
    items = [('valor', 'nome')]
    d = dict(items)

    def setDominio(self, dominio):
        self.dominio = dominio
        self.d['Dominio'] = dominio
        self.comando = 'theHarvester -d' + dominio.decode()+' -b all'  # nmap -v -A dominio

    def run(self):
        c = library.pegarSaidaShell(self.comando)
        for result in c:
            library.getVaribleTH(self.d, 'IP', result)
            library.getVaribleTH(self.d, 'Host', result)
            library.getVaribleTH(self.d, 'Email', result)