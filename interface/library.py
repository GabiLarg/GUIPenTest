import subprocess
import validators
def pegarSaidaShell(comando):
    print(comando)
    p = subprocess.Popen(comando.split(),
                    stdout=subprocess.PIPE,
                    stderr=subprocess.STDOUT)
    return iter(p.stdout.readline, b'')

def getVaribleNmap(d, name, text, searched, pre, post):
    tmp=text.decode()
    pos= tmp.find(searched)
    if pos>0:
        ini= tmp.find(pre)+ (len(pre)-1)
        if len(post)>0:
            fim= tmp.find(post)  
        else:
            fim= len(text)-1 
        tmp= str(text[ini+1:fim].decode()) 
        if len(tmp)>0:
            print(tmp)
            d[tmp]=name

def getVaribleTH(d, name, text):
    words = text.split(':')

    for word in words:
        word = word.replace('\n', '')
        if(name == 'IP'):
            if(validators.ipv4(word)):
                d[word] = name
        elif(name == 'Host'):
            if(validators.domain(word)):
                d[word] = name
        elif(name == 'Email'):
            if(validators.email(word)):
                d[word] = name