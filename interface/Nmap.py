import library


class NMap:
    operacional=''
    hosts=0  
    items= [('valor', 'nome')]
    d= dict(items)
    portas=[0, '', '']

    def setDominio(self, dominio):
        self.dominio = dominio
        self.d['Dominio']= dominio
        self.comando= 'nmap -v -A ' + dominio.decode()  #nmap -v -A dominio
    def run(self):
        c= library.pegarSaidaShell(self.comando)
        for result in c:            
            library.getVaribleNmap(self.d, 'IP', result, 'scan report for', '(', ')')
            library.getVaribleNmap(self.d, 'Outros enderecos', result, 'addresses for', ':', '')
            library.getVaribleNmap(self.d, 'porta', result, 'open port', 'port ', '/')
            library.getVaribleNmap(self.d, 'Sistema Operacional', result, 'OS guesses', ':', ',')
            


    
    
